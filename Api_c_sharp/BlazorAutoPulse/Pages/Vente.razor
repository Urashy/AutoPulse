@page "/vente"
@using BlazorAutoPulse.ViewModel
@inject VenteViewModel VM
@inject GetAllViewModel VMAll

<PageTitle>AutoPulse</PageTitle>

<div id="sell" class="page active">
    <div class="sell-container">
        <h2 class="section-title">Vendez Votre Voiture</h2>
        <div class="sell-form">
            @if(@VM.imageUpload != null){
                <form>
                    <h3 style="margin-bottom: 30px; color: #00d4ff;">Informations du v√©hicule</h3>

                    <div class="form-group">
                        <label>Photos du v√©hicule (la premi√®re sera la photo de couverture)</label>
                        <label for="vehiclePhotos" class="file-upload" style="cursor: pointer; display: block; border: 2px dashed #ccc; padding: 20px; text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 20px;">üì∏</div>
                            <p style="color: #aaa;">Cliquez pour ajouter des photos</p>
                            <p style="color: #666; font-size: 14px; margin-top: 10px;">JPG, PNG - Max 10 photos</p>
                        </label>
                        <InputFile id="vehiclePhotos" OnChange="@VM.UploadImage" multiple style="display:none"/>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Marque</label>
                            <select @onchange="VM.OnMarqueChanged">
                                <option value="0">BMW</option>
                                @if (VMAll.allMarques != null)
                                {
                                    @foreach (var marque in VMAll.allMarques)
                                    {
                                        <option value="@marque.IdMarque">@marque.LibelleMarque</option>
                                    }
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Mod√®le</label>
                            <select @onchange="VM.OnModeleChanged">
                                <option value="0">M4 CS</option>
                                @if (VMAll.allModeles != null)
                                {
                                    @foreach (var marque in VMAll.allModeles)
                                    {
                                        <option value="@marque.IdModele">@marque.LibelleModele</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Ann√©e</label>
                            <input type="number" placeholder="2021" required @bind="VM.annonce.Annee">
                        </div>
                        <div class="form-group">
                            <label>Kilom√©trage</label>
                            <input type="number" placeholder="45000" required @bind="VM.annonce.Kilometrage">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Carburant</label>
                            <select @onchange="VM.OnModeleChanged">
                                <option value="0">Essence</option>
                                @if (VMAll.allCarburants != null)
                                {
                                    @foreach (var marque in VMAll.allCarburants)
                                    {
                                        <option value="@marque.IdCarburant">@marque.LibelleCarburant</option>
                                    }
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Motricit√©</label>
                            <select @onchange="VM.OnModeleChanged">
                                <option value="0">Propulsion</option>
                                @if (VMAll.allMotricite != null)
                                {
                                    @foreach (var marque in VMAll.allMotricite)
                                    {
                                        <option value="@marque.IdMotricite">@marque.LibelleMotricite</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Prix souhait√© (‚Ç¨)</label>
                            <input type="number" placeholder="25000" required>
                            <button type="button" class="btn-ia" onclick="alert('Estimation IA : Bas√© sur les informations fournies, un prix juste se situerait entre 29 500 ‚Ç¨ et 31 000 ‚Ç¨.')">‚ú® Estimer le prix par l'IA</button>
                        </div>
                        <div class="form-group">
                            <label>Couleur</label>
                            <input type="text" placeholder="Noir, Blanc, Gris..." required @bind="VM.annonce.Couleur">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Adresse</label>
                        <input type="text" placeholder="123 rue de l'Exemple" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Code postal</label>
                            <input type="text" placeholder="73000" required>
                        </div>
                        <div class="form-group">
                            <label>Ville</label>
                            <input type="text" placeholder="Chamb√©ry" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Pays</label>
                        <input type="text" placeholder="France" required>
                    </div>

                    <div class="form-group">
                        <label>Description</label>
                        <textarea placeholder="D√©crivez votre v√©hicule, son √©tat, ses √©quipements..." required></textarea>
                    </div>

                    <button @onclick="@VM.CreateAnnonce" type="button" class="btn-submit" style="margin-top: 20px;">Publier mon annonce</button>
                </form>
            }
        </div>
    </div>
</div>


@code {
    protected override async Task OnInitializedAsync()
    {
        await VM.InitializeAsync(StateHasChanged);
    }
}